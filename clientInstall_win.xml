<project>
    <shortName>altibase</shortName>
    <fullName>ALTIBASE HDB Client ${altibase_base_version}</fullName>
    <version>${altibase_base_version}</version>
    <installerFilename>${product_shortname}-HDB-${altibase_product_type}-${altibase_base_version}.${altibase_tagset_version}.${altibase_tag_version}-${altibase_target_os}-${altibase_cfg_cpu_value}-${altibase_compile_bit}bit-${altibase_build_mode}.${platform_exec_suffix}</installerFilename>
    <debugLevel>4</debugLevel>
    <leftImage>ut/Installer/images/left_side.png</leftImage>
    <logoImage>ut/Installer/images/logo.png</logoImage>
    <preBuildActionList>
        <copyFile>
            <destination>${altibase_build_dir}/lib</destination>
            <origin>${additional_files_dir}/altibase_java/Altibase.jar</origin>
        </copyFile>
    </preBuildActionList>
    <initializationActionList>
        <actionGroup>
            <explanation>check previous installed version</explanation>
            <actionList>
                <registryFind>
                    <abortOnError>0</abortOnError>
                    <findAll>1</findAll>
                    <keyPattern>*ALTIBASE HDB Client ${altibase_base_version}</keyPattern>
                    <namePattern>*</namePattern>
                    <rootKey>HKEY_LOCAL_MACHINE\SOFTWARE</rootKey>
                    <searchDepth>2</searchDepth>
                    <showMessageOnError>0</showMessageOnError>
                    <variable>check_pre_product_a</variable>
                </registryFind>
                <registryFind>
                    <abortOnError>0</abortOnError>
                    <findAll>1</findAll>
                    <keyPattern>*ALTIBASE HDB Client ${altibase_base_version}</keyPattern>
                    <namePattern>*</namePattern>
                    <rootKey>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node</rootKey>
                    <searchDepth>2</searchDepth>
                    <showMessageOnError>0</showMessageOnError>
                    <variable>check_pre_product_b</variable>
                </registryFind>
                <if>
                    <conditionRuleEvaluationLogic>or</conditionRuleEvaluationLogic>
                    <explanation>check previous installed version</explanation>
                    <actionList>
                        <showWarning>
                            <text>The ALTIBASE HDB ${altibase_base_version} client has already been installed for use by all users of this computer.
In order to perform a full ALTIBASE HDB installation, it is first necessary to uninstall the previously installed ALTIBASE HDB ${altibase_base_version} client.
</text>
                        </showWarning>
                        <exit>
                            <exitCode>1</exitCode>
                        </exit>
                    </actionList>
                    <conditionRuleList>
                        <stringTest>
                            <text>${check_pre_product_a}</text>
                            <type>not_empty</type>
                        </stringTest>
                        <stringTest>
                            <text>${check_pre_product_b}</text>
                            <type>not_empty</type>
                        </stringTest>
                    </conditionRuleList>
                </if>
            </actionList>
        </actionGroup>
    </initializationActionList>
    <preInstallationActionList>
        <actionGroup>
            <explanation>check os bit</explanation>
            <actionList>
                <if>
                    <explanation>check bit</explanation>
                    <actionList>
                        <if>
                            <explanation>check compiled bit</explanation>
                            <actionList>
                                <showWarning>
                                    <text>This package is not suitable for this environment.
OS          : 64-bit
Package  : 32-bit</text>
                                </showWarning>
                            </actionList>
                            <conditionRuleList>
                                <compareText>
                                    <logic>equals</logic>
                                    <text>32</text>
                                    <value>${altibase_compile_bit}</value>
                                </compareText>
                            </conditionRuleList>
                        </if>
                    </actionList>
                    <conditionRuleList>
                        <platformTest>
                            <type>windows-x64</type>
                        </platformTest>
                    </conditionRuleList>
                    <elseActionList>
                        <if>
                            <explanation>check compiled bit</explanation>
                            <actionList>
                                <showWarning>
                                    <text>This package is not suitable for this environment.
OS          : 32-bit
Package  : 64-bit</text>
                                </showWarning>
                                <exit>
                                    <exitCode>1</exitCode>
                                </exit>
                            </actionList>
                            <conditionRuleList>
                                <compareText>
                                    <logic>equals</logic>
                                    <text>64</text>
                                    <value>${altibase_compile_bit}</value>
                                </compareText>
                            </conditionRuleList>
                        </if>
                    </elseActionList>
                </if>
            </actionList>
        </actionGroup>
    </preInstallationActionList>
    <readyToInstallActionList>
        <if>
            <explanation>scope</explanation>
            <actionList>
                <setInstallerVariable>
                    <name>project.windowsARPRegistryPrefix</name>
                    <value>altibase_client_tmp_arp</value>
                </setInstallerVariable>
                <setInstallerVariable>
                    <name>project.windowsSoftwareRegistryPrefix</name>
                    <value></value>
                </setInstallerVariable>
            </actionList>
            <conditionRuleList>
                <compareText>
                    <logic>equals</logic>
                    <text>user</text>
                    <value>${installationScope}</value>
                </compareText>
            </conditionRuleList>
        </if>
    </readyToInstallActionList>
    <postInstallationActionList>
        <actionGroup>
            <explanation>create aexport property file</explanation>
            <actionList>
                <copyFile>
                    <destination>${installdir}\conf\aexport.properties</destination>
                    <origin>${installdir}\conf\aexport.properties.sample</origin>
                </copyFile>
            </actionList>
        </actionGroup>
        <actionGroup>
            <explanation>set altibase path </explanation>
            <actionList>
                <if>
                    <explanation>check installation scope</explanation>
                    <actionList>
                        <addEnvironmentVariable>
                            <name>ALTIBASE_HOME</name>
                            <scope>user</scope>
                            <value>${installdir}</value>
                        </addEnvironmentVariable>
                        <addDirectoryToPath>
                            <insertAt>beginning</insertAt>
                            <path>${installdir}\bin</path>
                            <scope>user</scope>
                        </addDirectoryToPath>
                    </actionList>
                    <conditionRuleList>
                        <compareText>
                            <logic>equals</logic>
                            <text>user</text>
                            <value>${install_scope}</value>
                        </compareText>
                    </conditionRuleList>
                    <elseActionList>
                        <addEnvironmentVariable>
                            <name>ALTIBASE_HOME</name>
                            <scope>system</scope>
                            <value>${installdir}</value>
                        </addEnvironmentVariable>
                        <addDirectoryToPath>
                            <insertAt>beginning</insertAt>
                            <path>${installdir}\bin</path>
                        </addDirectoryToPath>
                    </elseActionList>
                </if>
                <setEnvironmentVariable>
                    <name>ALTIBASE_HOME</name>
                    <value>${installdir}</value>
                </setEnvironmentVariable>
                <setEnvironmentVariable>
                    <name>PATH</name>
                    <value>${installdir}\bin;%PATH%</value>
                </setEnvironmentVariable>
            </actionList>
        </actionGroup>
        <actionGroup>
            <explanation>install odbc driver</explanation>
            <actionList>
                <wow64FsRedirection>
                    <action>disable</action>
                </wow64FsRedirection>
                <if>
                    <explanation>check bits</explanation>
                    <actionList>
                        <if>
                            <explanation>check builded bits</explanation>
                            <actionList>
                                <setInstallerVariable>
                                    <name>odbc_copy_path</name>
                                    <value>${env(windir)}\system32</value>
                                </setInstallerVariable>
                                <if>
                                    <explanation>check prev file</explanation>
                                    <actionList>
                                        <showWarning>
                                            <text>The ALTIBASE HDB ODBC driver already installed.
${odbc_copy_path}\altiodbc.dll

The altiodbc.dll file will be overwritten.</text>
                                        </showWarning>
                                    </actionList>
                                    <conditionRuleList>
                                        <fileExists>
                                            <path>${odbc_copy_path}\altiodbc.dll</path>
                                        </fileExists>
                                    </conditionRuleList>
                                </if>
                                <copyFile>
                                    <abortOnError>0</abortOnError>
                                    <destination>${odbc_copy_path}\altiodbc.dll</destination>
                                    <origin>${installdir}\lib\altiodbc.dll</origin>
                                    <showMessageOnError>0</showMessageOnError>
                                    <onErrorActionList>
                                        <showWarning>
                                            <text>Can not copy  'altiodbc.dll' file to your system directory.</text>
                                        </showWarning>
                                    </onErrorActionList>
                                </copyFile>
                                <actionGroup>
                                    <explanation>registry 64os-64pkg</explanation>
                                    <actionList>
                                        <registrySet>
                                            <key>${ODBC_PATH}\${ODBC_IDENTIFIER}</key>
                                            <name></name>
                                            <type>REG_SZ</type>
                                            <value></value>
                                            <wowMode>64</wowMode>
                                        </registrySet>
                                        <registrySet>
                                            <key>${ODBC_PATH}\${ODBC_IDENTIFIER}</key>
                                            <name>CPTimeout</name>
                                            <type>REG_SZ</type>
                                            <value>${CP_Timeout}</value>
                                            <wowMode>64</wowMode>
                                        </registrySet>
                                        <registrySet>
                                            <key>${ODBC_PATH}\${ODBC_IDENTIFIER}</key>
                                            <name>Driver</name>
                                            <type>REG_SZ</type>
                                            <value>${odbc_copy_path}\altiodbc.dll</value>
                                            <wowMode>64</wowMode>
                                        </registrySet>
                                        <registrySet>
                                            <key>${ODBC_PATH}\${ODBC_IDENTIFIER}</key>
                                            <name>Setup</name>
                                            <type>REG_SZ</type>
                                            <value>${odbc_copy_path}\altiodbc.dll</value>
                                            <wowMode>64</wowMode>
                                        </registrySet>
                                        <registrySet>
                                            <key>${ODBC_PATH}\ODBC Drivers</key>
                                            <name>${ODBC_IDENTIFIER}</name>
                                            <type>REG_SZ</type>
                                            <value>Installed</value>
                                            <wowMode>64</wowMode>
                                        </registrySet>
                                        <wow64FsRedirection>
                                            <action>disable</action>
                                        </wow64FsRedirection>
                                    </actionList>
                                </actionGroup>
                            </actionList>
                            <conditionRuleList>
                                <compareText>
                                    <logic>equals</logic>
                                    <text>64</text>
                                    <value>${altibase_compile_bit}</value>
                                </compareText>
                            </conditionRuleList>
                            <elseActionList>
                                <setInstallerVariable>
                                    <name>odbc_copy_path</name>
                                    <value>${env(windir)}\SysWOW64</value>
                                </setInstallerVariable>
                                <if>
                                    <explanation>check prev file</explanation>
                                    <actionList>
                                        <showWarning>
                                            <text>The ALTIBASE HDB ODBC driver has already been installed.
${odbc_copy_path}\altiodbc.dll

The altiodbc.dll file will be overwritten.</text>
                                        </showWarning>
                                    </actionList>
                                    <conditionRuleList>
                                        <fileExists>
                                            <path>${odbc_copy_path}\altiodbc.dll</path>
                                        </fileExists>
                                    </conditionRuleList>
                                </if>
                                <copyFile>
                                    <abortOnError>0</abortOnError>
                                    <destination>${odbc_copy_path}\altiodbc.dll</destination>
                                    <origin>${installdir}\lib\altiodbc.dll</origin>
                                    <showMessageOnError>0</showMessageOnError>
                                    <onErrorActionList>
                                        <showWarning>
                                            <text>Can not copy  'altiodbc.dll' file to your system directory.</text>
                                        </showWarning>
                                    </onErrorActionList>
                                </copyFile>
                                <actionGroup>
                                    <explanation>registry 64os-32pkg</explanation>
                                    <actionList>
                                        <registrySet>
                                            <key>${ODBC_PATH_32_64BIT}\${ODBC_IDENTIFIER}</key>
                                            <name></name>
                                            <type>REG_SZ</type>
                                            <value></value>
                                            <wowMode>32</wowMode>
                                        </registrySet>
                                        <registrySet>
                                            <key>${ODBC_PATH_32_64BIT}\${ODBC_IDENTIFIER}</key>
                                            <name>CP_Timeout</name>
                                            <type>REG_SZ</type>
                                            <value>${CP_Timeout}</value>
                                            <wowMode>32</wowMode>
                                        </registrySet>
                                        <registrySet>
                                            <key>${ODBC_PATH_32_64BIT}\${ODBC_IDENTIFIER}</key>
                                            <name>Driver</name>
                                            <type>REG_SZ</type>
                                            <value>${odbc_copy_path}\altiodbc.dll</value>
                                            <wowMode>32</wowMode>
                                        </registrySet>
                                        <registrySet>
                                            <key>${ODBC_PATH_32_64BIT}\${ODBC_IDENTIFIER}</key>
                                            <name>Setup</name>
                                            <type>REG_SZ</type>
                                            <value>${odbc_copy_path}\altiodbc.dll</value>
                                            <wowMode>32</wowMode>
                                        </registrySet>
                                        <registrySet>
                                            <key>${ODBC_PATH_32_64BIT}\ODBC Drivers</key>
                                            <name>${ODBC_IDENTIFIER}</name>
                                            <type>REG_SZ</type>
                                            <value>Installed</value>
                                            <wowMode>32</wowMode>
                                        </registrySet>
                                        <wow64FsRedirection>
                                            <action>disable</action>
                                        </wow64FsRedirection>
                                    </actionList>
                                </actionGroup>
                            </elseActionList>
                        </if>
                    </actionList>
                    <conditionRuleList>
                        <platformTest>
                            <type>windows-x64</type>
                        </platformTest>
                    </conditionRuleList>
                    <elseActionList>
                        <if>
                            <explanation>check builded bits</explanation>
                            <actionList>
                                <throwError>
                                    <text>OS - Package bit error

OS : 32bit
Package : 64bit</text>
                                </throwError>
                            </actionList>
                            <conditionRuleList>
                                <compareText>
                                    <logic>equals</logic>
                                    <text>64</text>
                                    <value>${altibase_compile_bit}</value>
                                </compareText>
                            </conditionRuleList>
                            <elseActionList>
                                <setInstallerVariable>
                                    <name>odbc_copy_path</name>
                                    <value>${env(windir)}\System32</value>
                                </setInstallerVariable>
                                <if>
                                    <explanation>check prev file</explanation>
                                    <actionList>
                                        <showWarning>
                                            <text>The ALTIBASE HDB ODBC driver has already been installed.
${odbc_copy_path}\altiodbc.dll

The altiodbc.dll file will be overwritten.</text>
                                        </showWarning>
                                    </actionList>
                                    <conditionRuleList>
                                        <fileExists>
                                            <path>${odbc_copy_path}\altiodbc.dll</path>
                                        </fileExists>
                                    </conditionRuleList>
                                </if>
                                <copyFile>
                                    <abortOnError>0</abortOnError>
                                    <destination>${odbc_copy_path}\altiodbc.dll</destination>
                                    <origin>${installdir}\lib\altiodbc.dll</origin>
                                    <showMessageOnError>0</showMessageOnError>
                                    <onErrorActionList>
                                        <showWarning>
                                            <text>Can not copy  'altiodbc.dll' file to your system directory.</text>
                                        </showWarning>
                                    </onErrorActionList>
                                </copyFile>
                                <actionGroup>
                                    <explanation>registry</explanation>
                                    <actionList>
                                        <registrySet>
                                            <key>${ODBC_PATH}\${ODBC_IDENTIFIER}</key>
                                            <name></name>
                                            <type>REG_SZ</type>
                                            <value></value>
                                            <wowMode>32</wowMode>
                                        </registrySet>
                                        <registrySet>
                                            <key>${ODBC_PATH}\${ODBC_IDENTIFIER}</key>
                                            <name>CPTimeout</name>
                                            <type>REG_SZ</type>
                                            <value>${CP_Timeout}</value>
                                            <wowMode>32</wowMode>
                                        </registrySet>
                                        <registrySet>
                                            <key>${ODBC_PATH}\${ODBC_IDENTIFIER}</key>
                                            <name>Driver</name>
                                            <type>REG_SZ</type>
                                            <value>${odbc_copy_path}\altiodbc.dll</value>
                                            <wowMode>32</wowMode>
                                        </registrySet>
                                        <registrySet>
                                            <key>${ODBC_PATH}\${ODBC_IDENTIFIER}</key>
                                            <name>Setup</name>
                                            <type>REG_SZ</type>
                                            <value>${odbc_copy_path}\altiodbc.dll</value>
                                            <wowMode>32</wowMode>
                                        </registrySet>
                                        <registrySet>
                                            <key>${ODBC_PATH}\ODBC Drivers</key>
                                            <name>${ODBC_IDENTIFIER}</name>
                                            <type>REG_SZ</type>
                                            <value>Installed</value>
                                            <wowMode>32</wowMode>
                                        </registrySet>
                                        <wow64FsRedirection>
                                            <action>disable</action>
                                        </wow64FsRedirection>
                                    </actionList>
                                </actionGroup>
                            </elseActionList>
                        </if>
                    </elseActionList>
                </if>
            </actionList>
            <ruleList>
                <compareText>
                    <logic>equals</logic>
                    <text>yes</text>
                    <value>${odbc_setup}</value>
                </compareText>
            </ruleList>
        </actionGroup>
        <actionGroup>
            <explanation>make isql/iloader.bat file</explanation>
            <actionList>
                <writeFile>
                    <encoding>utf-8</encoding>
                    <path>${installdir}/bin/isql.bat</path>
                    <text>@echo off
"${installdir}\bin\isql.exe" %1 %2 %3 %4 %5 %6 %7 %8 %9

pause</text>
                </writeFile>
                <writeFile>
                    <encoding>utf-8</encoding>
                    <path>${installdir}/bin/iloader.bat</path>
                    <text>@echo off
"${installdir}\bin\iloader.exe" %1 %2 %3 %4 %5 %6 %7 %8 %9

pause</text>
                </writeFile>
            </actionList>
        </actionGroup>
        <actionGroup>
            <abortOnError>0</abortOnError>
            <explanation>Installation : Altibase entity provider</explanation>
            <actionList>
                <setInstallerVariableFromScriptOutput>
                    <abortOnError>0</abortOnError>
                    <exec>${installdir}\bin\AltibaseProviderInstaller.exe</exec>
                    <execArgs>install</execArgs>
                    <name>AltibaseProviderInstall</name>
                    <progressText>Installation : Altibase entity provider</progressText>
                    <workingDirectory>${installdir}\bin</workingDirectory>
                </setInstallerVariableFromScriptOutput>
            </actionList>
        </actionGroup>
        <actionGroup>
            <abortOnError>0</abortOnError>
            <explanation>install adonet</explanation>
            <actionList>
                <actionGroup>
                    <explanation>adonet MSDTC</explanation>
                    <actionList>
                        <if>
                            <explanation>check target os bit</explanation>
                            <actionList>
                                <if>
                                    <explanation>check builded bits</explanation>
                                    <actionList>
                                        <registrySet>
                                            <abortOnError>0</abortOnError>
                                            <key>${ADONET_MSDTC_PATH}</key>
                                            <name>odbccli_sl.dll</name>
                                            <progressText>set regestry key for ado.net MSDTC.</progressText>
                                            <type>REG_EXPAND_SZ</type>
                                            <value>${installdir}\lib\odbccli_sl.dll</value>
                                            <wowMode>64</wowMode>
                                        </registrySet>
                                    </actionList>
                                    <conditionRuleList>
                                        <compareText>
                                            <logic>equals</logic>
                                            <text>64</text>
                                            <value>${altibase_compile_bit}</value>
                                        </compareText>
                                    </conditionRuleList>
                                    <elseActionList>
                                        <registrySet>
                                            <abortOnError>0</abortOnError>
                                            <key>${ADONET_MSDTC_PATH}</key>
                                            <name>odbccli_sl.dll</name>
                                            <progressText>set regestry key for ado.net MSDTC.</progressText>
                                            <type>REG_EXPAND_SZ</type>
                                            <value>${installdir}\lib\odbccli_sl.dll</value>
                                            <wowMode>32</wowMode>
                                        </registrySet>
                                    </elseActionList>
                                </if>
                            </actionList>
                            <conditionRuleList>
                                <platformTest>
                                    <type>windows-x64</type>
                                </platformTest>
                            </conditionRuleList>
                            <elseActionList>
                                <if>
                                    <explanation>check builded bits</explanation>
                                    <actionList>
                                        <throwError>
                                            <text>OS - Package bit error

OS : 32bit
Package : 64bit</text>
                                        </throwError>
                                    </actionList>
                                    <conditionRuleList>
                                        <compareText>
                                            <logic>equals</logic>
                                            <text>64</text>
                                            <value>${altibase_compile_bit}</value>
                                        </compareText>
                                    </conditionRuleList>
                                    <elseActionList>
                                        <registrySet>
                                            <abortOnError>0</abortOnError>
                                            <key>${ADONET_MSDTC_PATH}</key>
                                            <name>odbccli_sl.dll</name>
                                            <progressText>set regestry key for ado.net MSDTC.</progressText>
                                            <type>REG_EXPAND_SZ</type>
                                            <value>${installdir}\lib\odbccli_sl.dll</value>
                                            <wowMode>32</wowMode>
                                        </registrySet>
                                    </elseActionList>
                                </if>
                            </elseActionList>
                        </if>
                    </actionList>
                </actionGroup>
            </actionList>
        </actionGroup>
    </postInstallationActionList>
    <postUninstallerCreationActionList>
        <actionGroup>
            <explanation>remove ARP ${project.fullName}_tmp_arp</explanation>
            <actionList>
                <registryFind>
                    <abortOnError>0</abortOnError>
                    <findAll>1</findAll>
                    <keyPattern>*altibase_client_tmp_arp*</keyPattern>
                    <namePattern>*</namePattern>
                    <rootKey>HKEY_LOCAL_MACHINE\SOFTWARE</rootKey>
                    <searchDepth>10</searchDepth>
                    <variable>tmp_arp</variable>
                </registryFind>
                <foreach>
                    <values>${tmp_arp}</values>
                    <variables>key name values</variables>
                    <actionList>
                        <registryDelete>
                            <abortOnError>0</abortOnError>
                            <key>${key}</key>
                            <name></name>
                        </registryDelete>
                    </actionList>
                    <ruleList>
                        <stringTest>
                            <text>${tmp_arp}</text>
                            <type>not_empty</type>
                        </stringTest>
                    </ruleList>
                </foreach>
            </actionList>
            <ruleList>
                <compareText>
                    <logic>equals</logic>
                    <text>user</text>
                    <value>${installationScope}</value>
                </compareText>
            </ruleList>
        </actionGroup>
    </postUninstallerCreationActionList>
    <preUninstallationActionList>
        <actionGroup>
            <abortOnError>0</abortOnError>
            <explanation>Un-Installation : Altibase entity provider</explanation>
            <actionList>
                <setInstallerVariableFromScriptOutput>
                    <abortOnError>0</abortOnError>
                    <exec>${installdir}\bin\AltibaseProviderInstaller.exe</exec>
                    <execArgs>remove</execArgs>
                    <name>AltibaseProviderRemove</name>
                    <progressText>Un-Installation : Altibase entity provider</progressText>
                    <workingDirectory>${installdir}\bin</workingDirectory>
                </setInstallerVariableFromScriptOutput>
            </actionList>
        </actionGroup>
    </preUninstallationActionList>
    <postUninstallationActionList>
        <actionGroup>
            <explanation>un-set Altibase path</explanation>
            <actionList>
                <if>
                    <explanation>check installation scope</explanation>
                    <actionList>
                        <deleteEnvironmentVariable>
                            <abortOnError>0</abortOnError>
                            <name>ALTIBASE_HOME</name>
                            <scope>user</scope>
                        </deleteEnvironmentVariable>
                        <removeDirectoryFromPath>
                            <abortOnError>0</abortOnError>
                            <path>${installdir}\bin</path>
                            <scope>user</scope>
                        </removeDirectoryFromPath>
                    </actionList>
                    <conditionRuleList>
                        <compareText>
                            <logic>equals</logic>
                            <text>user</text>
                            <value>${install_scope}</value>
                        </compareText>
                    </conditionRuleList>
                    <elseActionList>
                        <deleteEnvironmentVariable>
                            <abortOnError>0</abortOnError>
                            <name>ALTIBASE_HOME</name>
                            <scope>system</scope>
                        </deleteEnvironmentVariable>
                        <removeDirectoryFromPath>
                            <abortOnError>0</abortOnError>
                            <path>${installdir}\bin</path>
                        </removeDirectoryFromPath>
                    </elseActionList>
                </if>
            </actionList>
        </actionGroup>
        <actionGroup>
            <explanation>delete odbc driver</explanation>
            <actionList>
                <if>
                    <explanation>check bits</explanation>
                    <actionList>
                        <wow64FsRedirection>
                            <action>disable</action>
                        </wow64FsRedirection>
                        <if>
                            <explanation>check builded bits</explanation>
                            <actionList>
                                <deleteFile>
                                    <abortOnError>0</abortOnError>
                                    <customErrorMessage>Can not delete  'altiodbc.dll' file to your system directory. </customErrorMessage>
                                    <path>${env(windir)}\System32\altiodbc.dll</path>
                                </deleteFile>
                                <registryDelete>
                                    <abortOnError>0</abortOnError>
                                    <key>${ODBC_PATH}\${ODBC_IDENTIFIER}</key>
                                    <name>CPTimeout</name>
                                    <showMessageOnError>0</showMessageOnError>
                                    <wowMode>64</wowMode>
                                </registryDelete>
                                <registryDelete>
                                    <abortOnError>0</abortOnError>
                                    <key>${ODBC_PATH}\${ODBC_IDENTIFIER}</key>
                                    <name>Driver</name>
                                    <showMessageOnError>0</showMessageOnError>
                                    <wowMode>64</wowMode>
                                </registryDelete>
                                <registryDelete>
                                    <abortOnError>0</abortOnError>
                                    <key>${ODBC_PATH}\${ODBC_IDENTIFIER}</key>
                                    <name>Setup</name>
                                    <showMessageOnError>0</showMessageOnError>
                                    <wowMode>64</wowMode>
                                </registryDelete>
                                <registryDelete>
                                    <abortOnError>0</abortOnError>
                                    <key>${ODBC_PATH}\ODBC Drivers</key>
                                    <name>${ODBC_IDENTIFIER}</name>
                                    <showMessageOnError>0</showMessageOnError>
                                    <wowMode>64</wowMode>
                                </registryDelete>
                                <registryDelete>
                                    <abortOnError>0</abortOnError>
                                    <key>${ODBC_PATH}\${ODBC_IDENTIFIER}</key>
                                    <name></name>
                                    <showMessageOnError>0</showMessageOnError>
                                    <wowMode>64</wowMode>
                                </registryDelete>
                            </actionList>
                            <conditionRuleList>
                                <compareText>
                                    <logic>equals</logic>
                                    <text>64</text>
                                    <value>${altibase_compile_bit}</value>
                                </compareText>
                            </conditionRuleList>
                            <elseActionList>
                                <deleteFile>
                                    <abortOnError>0</abortOnError>
                                    <customErrorMessage>Can not delete  'altiodbc.dll' file to your system directory. </customErrorMessage>
                                    <path>${env(windir)}\SysWOW64\altiodbc.dll</path>
                                </deleteFile>
                                <registryDelete>
                                    <abortOnError>0</abortOnError>
                                    <key>${ODBC_PATH_32_64BIT}\${ODBC_IDENTIFIER}</key>
                                    <name>CPTimeout</name>
                                    <showMessageOnError>0</showMessageOnError>
                                    <wowMode>32</wowMode>
                                </registryDelete>
                                <registryDelete>
                                    <abortOnError>0</abortOnError>
                                    <key>${ODBC_PATH_32_64BIT}\${ODBC_IDENTIFIER}</key>
                                    <name>Driver</name>
                                    <showMessageOnError>0</showMessageOnError>
                                    <wowMode>32</wowMode>
                                </registryDelete>
                                <registryDelete>
                                    <abortOnError>0</abortOnError>
                                    <key>${ODBC_PATH_32_64BIT}\${ODBC_IDENTIFIER}</key>
                                    <name>Setup</name>
                                    <showMessageOnError>0</showMessageOnError>
                                    <wowMode>32</wowMode>
                                </registryDelete>
                                <registryDelete>
                                    <abortOnError>0</abortOnError>
                                    <key>${ODBC_PATH_32_64BIT}\ODBC Drivers</key>
                                    <name>${ODBC_IDENTIFIER}</name>
                                    <showMessageOnError>0</showMessageOnError>
                                    <wowMode>32</wowMode>
                                </registryDelete>
                                <registryDelete>
                                    <abortOnError>0</abortOnError>
                                    <key>${ODBC_PATH_32_64BIT}\${ODBC_IDENTIFIER}</key>
                                    <name></name>
                                    <showMessageOnError>0</showMessageOnError>
                                    <wowMode>32</wowMode>
                                </registryDelete>
                            </elseActionList>
                        </if>
                    </actionList>
                    <conditionRuleList>
                        <platformTest>
                            <type>windows-x64</type>
                        </platformTest>
                    </conditionRuleList>
                    <elseActionList>
                        <wow64FsRedirection>
                            <action>disable</action>
                        </wow64FsRedirection>
                        <if>
                            <explanation>check builded bits</explanation>
                            <actionList>
                                <throwError>
                                    <text>OS - Package bit error

OS : 32it
Package : 64bit</text>
                                </throwError>
                            </actionList>
                            <conditionRuleList>
                                <compareText>
                                    <logic>equals</logic>
                                    <text>64</text>
                                    <value>${altibase_compile_bit}</value>
                                </compareText>
                            </conditionRuleList>
                            <elseActionList>
                                <deleteFile>
                                    <abortOnError>0</abortOnError>
                                    <customErrorMessage>Can not delete  'altiodbc.dll' file to your system directory. </customErrorMessage>
                                    <path>${env(windir)}\System32\altiodbc.dll</path>
                                </deleteFile>
                            </elseActionList>
                        </if>
                        <registryDelete>
                            <abortOnError>0</abortOnError>
                            <key>${ODBC_PATH}\${ODBC_IDENTIFIER}</key>
                            <name>CPTimeout</name>
                            <showMessageOnError>0</showMessageOnError>
                            <wowMode>32</wowMode>
                        </registryDelete>
                        <registryDelete>
                            <abortOnError>0</abortOnError>
                            <key>${ODBC_PATH}\${ODBC_IDENTIFIER}</key>
                            <name>Driver</name>
                            <showMessageOnError>0</showMessageOnError>
                            <wowMode>32</wowMode>
                        </registryDelete>
                        <registryDelete>
                            <abortOnError>0</abortOnError>
                            <key>${ODBC_PATH}\${ODBC_IDENTIFIER}</key>
                            <name>Setup</name>
                            <showMessageOnError>0</showMessageOnError>
                            <wowMode>32</wowMode>
                        </registryDelete>
                        <registryDelete>
                            <abortOnError>0</abortOnError>
                            <key>${ODBC_PATH}\ODBC Drivers</key>
                            <name>${ODBC_IDENTIFIER}</name>
                            <showMessageOnError>0</showMessageOnError>
                            <wowMode>32</wowMode>
                        </registryDelete>
                        <registryDelete>
                            <abortOnError>0</abortOnError>
                            <key>${ODBC_PATH}\${ODBC_IDENTIFIER}</key>
                            <name></name>
                            <showMessageOnError>0</showMessageOnError>
                            <wowMode>32</wowMode>
                        </registryDelete>
                    </elseActionList>
                </if>
            </actionList>
            <ruleList>
                <compareText>
                    <logic>equals</logic>
                    <text>yes</text>
                    <value>${odbc_setup}</value>
                </compareText>
            </ruleList>
        </actionGroup>
        <actionGroup>
            <explanation>delete altibase directories</explanation>
            <actionList>
                <deleteFile>
                    <abortOnError>0</abortOnError>
                    <path>${installdir}\APatch\rollback-p*.exe</path>
                    <showMessageOnError>0</showMessageOnError>
                </deleteFile>
                <deleteFile>
                    <abortOnError>0</abortOnError>
                    <path>${installdir}\APatch\uninstall-p*.exe</path>
                    <showMessageOnError>0</showMessageOnError>
                </deleteFile>
                <deleteFile>
                    <abortOnError>0</abortOnError>
                    <path>${installdir}\APatch\rollback-p*\</path>
                    <showMessageOnError>0</showMessageOnError>
                </deleteFile>
                <deleteFile>
                    <abortOnError>0</abortOnError>
                    <path>${installdir}\APatch\pkg_patch_*.txt</path>
                    <showMessageOnError>0</showMessageOnError>
                </deleteFile>
                <deleteFile>
                    <abortOnError>0</abortOnError>
                    <path>${installdir}\"Uninstall ALTIBASE HDB*.lnk"</path>
                    <showMessageOnError>0</showMessageOnError>
                </deleteFile>
            </actionList>
        </actionGroup>
        <actionGroup>
            <explanation>delete adonet MSDTC</explanation>
            <actionList>
                <if>
                    <actionList>
                        <registryDelete>
                            <abortOnError>0</abortOnError>
                            <key>${ADONET_MSDTC_PATH}</key>
                            <name>odbccli_sl.dll</name>
                            <progressText>delete ado.net MSDTC regestry key.</progressText>
                            <wowMode>64</wowMode>
                        </registryDelete>
                    </actionList>
                    <conditionRuleList>
                        <compareText>
                            <logic>equals</logic>
                            <text>64</text>
                            <value>${altibase_compile_bit}</value>
                        </compareText>
                    </conditionRuleList>
                    <elseActionList>
                        <registryDelete>
                            <abortOnError>0</abortOnError>
                            <key>${ADONET_MSDTC_PATH}</key>
                            <name>odbccli_sl.dll</name>
                            <progressText>delete ado.net MSDTC regestry key.</progressText>
                            <wowMode>32</wowMode>
                        </registryDelete>
                    </elseActionList>
                </if>
            </actionList>
        </actionGroup>
    </postUninstallationActionList>
    <disableSplashScreen>1</disableSplashScreen>
    <enableRollback>0</enableRollback>
    <enableTimestamp>1</enableTimestamp>
    <height>544</height>
    <installationLogFile>${installdir}/APatch/altibase_base_install.log</installationLogFile>
    <installationScope>user</installationScope>
    <licenseFileEncoding>utf-8</licenseFileEncoding>
    <outputDirectory>${build_project_directory}</outputDirectory>
    <productDisplayIcon>${installdir}/win-exe-icon.ico</productDisplayIcon>
    <readmeFileEncoding>utf-8</readmeFileEncoding>
    <requireInstallationByRootUser>1</requireInstallationByRootUser>
    <saveRelativePaths>1</saveRelativePaths>
    <startMenuGroupName>ALTIBASE HDB Client ${altibase_base_version}</startMenuGroupName>
    <uninstallationLogFile>${installdir}/APatch/altibase_base_uninstall.log</uninstallationLogFile>
    <uninstallerDirectory>${installdir}/APatch</uninstallerDirectory>
    <uninstallerName>uninstall-base</uninstallerName>
    <vendor>Altibase Corp.,</vendor>
    <width>700</width>
    <windowsExecutableIcon>ut/Installer/images/win-exe-icon.ico</windowsExecutableIcon>
    <windowsSoftwareRegistryPrefix>${project.vendor}\ALTIBASE HDB Client ${altibase_base_version}</windowsSoftwareRegistryPrefix>
    <windowsUninstallerExecutableIcon>ut/Installer/images/win-exe-icon.ico</windowsUninstallerExecutableIcon>
    <componentList>
        <component>
            <name>default</name>
            <description>ALTIBASE client</description>
            <canBeEdited>0</canBeEdited>
            <detailedDescription>ALTIBASE HDB Client

ALTIBASE HDB Client module</detailedDescription>
            <selected>1</selected>
            <show>1</show>
            <folderList>
                <folder>
                    <description>Program Files</description>
                    <destination>${installdir}</destination>
                    <name>programfiles</name>
                    <platforms>all</platforms>
                    <distributionFileList>
                        <distributionDirectory>
                            <origin>altipkgdir_client_win/admin</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>altipkgdir_client_win/APatch</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>altipkgdir_client_win/altiComp</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>altipkgdir_client_win/bin</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>altipkgdir_client_win/conf</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>altipkgdir_client_win/include</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>altipkgdir_client_win/install</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>altipkgdir_client_win/lib</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>altipkgdir_client_win/msg</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>altipkgdir_client_win/sample</origin>
                        </distributionDirectory>
                        <distributionDirectory>
                            <origin>altipkgdir_client_win/thirdparty</origin>
                        </distributionDirectory>
                        <distributionFile>
                            <origin>altipkgdir_client_win/report.txt</origin>
                        </distributionFile>
                        <distributionFile>
                            <origin>ut/Installer/images/win-exe-icon.ico</origin>
                        </distributionFile>
                    </distributionFileList>
                    <shortcutList>
                        <shortcut>
                            <comment>Uninstall</comment>
                            <exec></exec>
                            <icon></icon>
                            <name>Uninstall ${product_fullname}</name>
                            <path></path>
                            <platforms>windows</platforms>
                            <runAsAdmin>0</runAsAdmin>
                            <runInTerminal>0</runInTerminal>
                            <windowsExec>${installdir}\APatch\${uninstallerName}.exe</windowsExec>
                            <windowsExecArgs></windowsExecArgs>
                            <windowsIcon>${installdir}/win-exe-icon.ico</windowsIcon>
                            <windowsPath>${installdir}</windowsPath>
                        </shortcut>
                    </shortcutList>
                </folder>
            </folderList>
            <startMenuShortcutList>
                <startMenuShortcut>
                    <comment>Uninstall ${product_fullname}</comment>
                    <name>Uninstall ${product_fullname}</name>
                    <runAsAdmin>0</runAsAdmin>
                    <runInTerminal>0</runInTerminal>
                    <windowsExec>${installdir}/APatch/${uninstallerName}.exe</windowsExec>
                    <windowsExecArgs></windowsExecArgs>
                    <windowsIcon>${installdir}/win-exe-icon.ico</windowsIcon>
                    <windowsPath>${installdir}/</windowsPath>
                </startMenuShortcut>
                <startMenuShortcut>
                    <comment>ISQL</comment>
                    <name>ISQL</name>
                    <runAsAdmin>0</runAsAdmin>
                    <runInTerminal>0</runInTerminal>
                    <windowsExec>${installdir}/bin/isql.bat</windowsExec>
                    <windowsExecArgs></windowsExecArgs>
                    <windowsIcon>${installdir}/win-exe-icon.ico</windowsIcon>
                    <windowsPath>${installdir}/</windowsPath>
                </startMenuShortcut>
                <startMenuShortcut>
                    <comment>ILOADER</comment>
                    <name>ILOADER</name>
                    <runAsAdmin>0</runAsAdmin>
                    <runInTerminal>0</runInTerminal>
                    <windowsExec>${installdir}/bin/iloader.bat</windowsExec>
                    <windowsExecArgs></windowsExecArgs>
                    <windowsIcon>${installdir}/win-exe-icon.ico</windowsIcon>
                    <windowsPath>${installdir}/</windowsPath>
                </startMenuShortcut>
            </startMenuShortcutList>
        </component>
    </componentList>
    <customLanguageFileList>
        <language>
            <code>en</code>
            <file>altibase_home/APatch/client-custom-en.lng</file>
        </language>
    </customLanguageFileList>
    <parameterList>
        <stringParameter>
            <name>patch_dir</name>
            <description></description>
            <explanation></explanation>
            <value>${installdir}\APatch</value>
            <default></default>
            <allowEmptyValue>1</allowEmptyValue>
            <ask>0</ask>
            <width>30</width>
        </stringParameter>
        <stringParameter>
            <name>patch_info_file</name>
            <description></description>
            <explanation></explanation>
            <value>${patch_dir}\patchinfo</value>
            <default></default>
            <allowEmptyValue>1</allowEmptyValue>
            <ask>0</ask>
            <width>30</width>
        </stringParameter>
        <directoryParameter>
            <name>installdir</name>
            <description>Installation directory : ALTIBASE HDB Client</description>
            <explanation>Please specify the installation directory for ALTIBASE HDB Client ${altibase_base_version}. </explanation>
            <value></value>
            <default>${platform_install_prefix}/Altibase/${product_shortname}-HDB-${altibase_product_type}-${product_version}</default>
            <allowEmptyValue>0</allowEmptyValue>
            <mustBeWritable>1</mustBeWritable>
            <mustExist>0</mustExist>
            <width>50</width>
            <preShowPageActionList>
                <setInstallerVariable>
                    <name>back_page</name>
                    <value></value>
                </setInstallerVariable>
                <setInstallerVariable>
                    <name>next_page</name>
                    <value></value>
                </setInstallerVariable>
            </preShowPageActionList>
            <validationActionList>
                <if>
                    <explanation>check install path</explanation>
                    <actionList>
                        <showWarning>
                            <text>The ALTIBASE HDB Client package cannot be installed in
${installdir}
because a previous version is already installed in the same location.

Please uninstall the previous version of the ALTIBASE HDB Client and try again.
</text>
                        </showWarning>
                        <setInstallerVariable>
                            <name>next_page</name>
                            <value>installdir</value>
                        </setInstallerVariable>
                    </actionList>
                    <conditionRuleList>
                        <fileExists>
                            <path>${patch_dir}\patchinfo</path>
                        </fileExists>
                    </conditionRuleList>
                    <elseActionList>
                        <setInstallerVariable>
                            <name>next_page</name>
                            <value>set_odbc_iscope</value>
                        </setInstallerVariable>
                    </elseActionList>
                </if>
            </validationActionList>
        </directoryParameter>
        <stringParameter>
            <name>altibase_target_os</name>
            <description></description>
            <explanation></explanation>
            <value></value>
            <default></default>
            <allowEmptyValue>0</allowEmptyValue>
            <ask>0</ask>
            <width>30</width>
        </stringParameter>
        <stringParameter>
            <name>altibase_product_type</name>
            <description></description>
            <explanation></explanation>
            <value>client</value>
            <default></default>
            <allowEmptyValue>1</allowEmptyValue>
            <ask>0</ask>
            <width>30</width>
        </stringParameter>
        <stringParameter>
            <name>altibase_base_version</name>
            <description></description>
            <explanation></explanation>
            <value></value>
            <default></default>
            <allowEmptyValue>0</allowEmptyValue>
            <ask>0</ask>
            <width>30</width>
        </stringParameter>
        <stringParameter>
            <name>altibase_from_tagset_version</name>
            <description></description>
            <explanation></explanation>
            <value></value>
            <default>0</default>
            <allowEmptyValue>1</allowEmptyValue>
            <ask>0</ask>
            <width>30</width>
        </stringParameter>
        <stringParameter>
            <name>altibase_from_tag_version</name>
            <description></description>
            <explanation></explanation>
            <value></value>
            <default>0</default>
            <allowEmptyValue>1</allowEmptyValue>
            <ask>0</ask>
            <width>30</width>
        </stringParameter>
        <stringParameter>
            <name>altibase_tagset_version</name>
            <description></description>
            <explanation></explanation>
            <value></value>
            <default>0</default>
            <allowEmptyValue>1</allowEmptyValue>
            <ask>0</ask>
            <width>30</width>
        </stringParameter>
        <stringParameter>
            <name>altibase_tag_version</name>
            <description></description>
            <explanation></explanation>
            <value></value>
            <default>0</default>
            <allowEmptyValue>1</allowEmptyValue>
            <ask>0</ask>
            <width>30</width>
        </stringParameter>
        <stringParameter>
            <name>altibase_patch_version</name>
            <description></description>
            <explanation></explanation>
            <value>${altibase_from_tagset_version}_${altibase_from_tag_version}_${altibase_tagset_version}_${altibase_tag_version}</value>
            <default>0</default>
            <allowEmptyValue>1</allowEmptyValue>
            <ask>0</ask>
            <width>30</width>
        </stringParameter>
        <stringParameter>
            <name>altibase_compile_bit</name>
            <description></description>
            <explanation></explanation>
            <value>64</value>
            <default>64</default>
            <allowEmptyValue>1</allowEmptyValue>
            <ask>0</ask>
            <width>30</width>
        </stringParameter>
        <stringParameter>
            <name>altibase_cfg_cpu_value</name>
            <description></description>
            <explanation></explanation>
            <value></value>
            <default>0</default>
            <allowEmptyValue>1</allowEmptyValue>
            <ask>0</ask>
            <width>30</width>
        </stringParameter>
        <stringParameter>
            <name>altibase_build_mode</name>
            <description></description>
            <explanation></explanation>
            <value>debug</value>
            <default>debug</default>
            <allowEmptyValue>0</allowEmptyValue>
            <ask>0</ask>
            <width>30</width>
        </stringParameter>
        <stringParameter>
            <name>altibase_product_signature</name>
            <description></description>
            <explanation></explanation>
            <value>${altibase_product_type}-${altibase_base_version}-${altibase_compile_bit}-${altibase_build_mode}</value>
            <default>${altibase_product_type}-${altibase_base_version}-${altibase_compile_bit}-${altibase_build_mode}</default>
            <allowEmptyValue>0</allowEmptyValue>
            <ask>0</ask>
            <width>30</width>
        </stringParameter>
        <stringParameter>
            <name>altibase_build_dir</name>
            <description></description>
            <explanation></explanation>
            <value></value>
            <default></default>
            <allowEmptyValue>1</allowEmptyValue>
            <ask>0</ask>
            <width>40</width>
        </stringParameter>
        <stringParameter>
            <name>additional_files_dir</name>
            <description></description>
            <explanation></explanation>
            <value>../pgm_pkg</value>
            <default></default>
            <allowEmptyValue>1</allowEmptyValue>
            <ask>0</ask>
            <width>40</width>
        </stringParameter>
        <stringParameter>
            <name>CP_Timeout</name>
            <description></description>
            <explanation></explanation>
            <value></value>
            <default>60</default>
            <allowEmptyValue>1</allowEmptyValue>
            <ask>0</ask>
            <width>40</width>
        </stringParameter>
        <stringParameter>
            <name>ODBC_PATH</name>
            <description></description>
            <explanation></explanation>
            <value></value>
            <default>HKEY_LOCAL_MACHINE\Software\ODBC\ODBCINST.INI</default>
            <allowEmptyValue>1</allowEmptyValue>
            <ask>0</ask>
            <width>40</width>
        </stringParameter>
        <stringParameter>
            <name>ODBC_PATH_32_64BIT</name>
            <description></description>
            <explanation></explanation>
            <value></value>
            <default>HKEY_LOCAL_MACHINE\Software\Wow6432Node\ODBC\ODBCINST.INI</default>
            <allowEmptyValue>1</allowEmptyValue>
            <ask>0</ask>
            <width>40</width>
        </stringParameter>
        <stringParameter>
            <name>ODBC_IDENTIFIER</name>
            <description></description>
            <explanation></explanation>
            <value></value>
            <default>ALTIBASE_HDB_ODBC_${altibase_compile_bit}bit</default>
            <allowEmptyValue>1</allowEmptyValue>
            <ask>0</ask>
            <width>40</width>
        </stringParameter>
        <parameterGroup>
            <name>set_odbc_iscope</name>
            <title>Additional Installation Options</title>
            <explanation></explanation>
            <value></value>
            <default></default>
            <parameterList>
                <choiceParameter>
                    <name>install_scope</name>
                    <title>Installation scope</title>
                    <description></description>
                    <explanation>Do you want to install ALTIBASE HDB for the current user, or for all users of this computer?</explanation>
                    <value></value>
                    <default></default>
                    <allowEmptyValue>1</allowEmptyValue>
                    <displayType>combobox</displayType>
                    <ordering>default</ordering>
                    <width>20</width>
                    <optionList>
                        <option>
                            <description></description>
                            <image></image>
                            <text>All Users</text>
                            <value>system</value>
                        </option>
                        <option>
                            <description></description>
                            <image></image>
                            <text>The Current User</text>
                            <value>user</value>
                        </option>
                    </optionList>
                    <postShowPageActionList>
                        <actionGroup>
                            <explanation>set installationScope</explanation>
                            <actionList>
                                <if>
                                    <explanation>installation scope</explanation>
                                    <actionList>
                                        <setInstallerVariable>
                                            <name>installationScope</name>
                                            <value>user</value>
                                        </setInstallerVariable>
                                    </actionList>
                                    <conditionRuleList>
                                        <compareText>
                                            <logic>equals</logic>
                                            <text>user</text>
                                            <value>${install_scope}</value>
                                        </compareText>
                                    </conditionRuleList>
                                    <elseActionList>
                                        <setInstallerVariable>
                                            <name>installationScope</name>
                                            <value>system</value>
                                        </setInstallerVariable>
                                    </elseActionList>
                                </if>
                            </actionList>
                        </actionGroup>
                    </postShowPageActionList>
                </choiceParameter>
                <labelParameter>
                    <name>empty_space</name>
                    <description></description>
                    <explanation></explanation>
                    <image></image>
                </labelParameter>
                <choiceParameter>
                    <name>odbc_setup</name>
                    <title>ODBC Setup</title>
                    <description></description>
                    <explanation>Do you want to install the ALTIBASE HDB ODBC driver?
The ODBC driver will be available for use by all users, even if you install ALTIBASE HDB only for the current user.</explanation>
                    <value></value>
                    <default></default>
                    <allowEmptyValue>1</allowEmptyValue>
                    <displayType>combobox</displayType>
                    <insertAfter>install_scope</insertAfter>
                    <ordering>default</ordering>
                    <width>20</width>
                    <optionList>
                        <option>
                            <description></description>
                            <image></image>
                            <text>Yes</text>
                            <value>yes</value>
                        </option>
                        <option>
                            <description></description>
                            <image></image>
                            <text>No</text>
                            <value>no</value>
                        </option>
                    </optionList>
                    <validationActionList>
                        <if>
                            <explanation>check Q</explanation>
                            <actionList>
                                <if>
                                    <conditionRuleEvaluationLogic>or</conditionRuleEvaluationLogic>
                                    <explanation>check result</explanation>
                                    <actionList>
                                        <showQuestion>
                                            <default>no</default>
                                            <text>The ALTIBASE HDB ODBC driver has already been installed.
Would you like to overwrite the previously  installed driver?</text>
                                            <variable>odbc_reinstall_q</variable>
                                        </showQuestion>
                                        <if>
                                            <explanation>odbc re install</explanation>
                                            <actionList>
                                                <setInstallerVariable>
                                                    <name>odbc_setup</name>
                                                    <value>no</value>
                                                </setInstallerVariable>
                                            </actionList>
                                            <conditionRuleList>
                                                <compareText>
                                                    <logic>equals</logic>
                                                    <text>no</text>
                                                    <value>${odbc_reinstall_q}</value>
                                                </compareText>
                                            </conditionRuleList>
                                            <elseActionList>
                                                <setInstallerVariable>
                                                    <name>odbc_setup</name>
                                                    <value>yes</value>
                                                </setInstallerVariable>
                                            </elseActionList>
                                        </if>
                                    </actionList>
                                    <conditionRuleList>
                                        <registryTest>
                                            <key>${ODBC_PATH}\${ODBC_IDENTIFIER}\</key>
                                            <logic>exists</logic>
                                            <name>Setup</name>
                                            <wowMode>32</wowMode>
                                        </registryTest>
                                        <registryTest>
                                            <key>${ODBC_PATH}\${ODBC_IDENTIFIER}\</key>
                                            <logic>exists</logic>
                                            <name>Setup</name>
                                            <wowMode>64</wowMode>
                                        </registryTest>
                                    </conditionRuleList>
                                </if>
                            </actionList>
                            <conditionRuleList>
                                <compareText>
                                    <logic>equals</logic>
                                    <text>yes</text>
                                    <value>${odbc_setup}</value>
                                </compareText>
                            </conditionRuleList>
                        </if>
                    </validationActionList>
                </choiceParameter>
            </parameterList>
            <postShowPageActionList>
                <setInstallerVariable>
                    <name>back_page</name>
                    <value>set_odbc_iscope</value>
                </setInstallerVariable>
            </postShowPageActionList>
            <preShowPageActionList>
                <setInstallerVariable>
                    <name>next_page</name>
                    <value>readytoinstall</value>
                </setInstallerVariable>
                <setInstallerVariable>
                    <name>back_page</name>
                    <value>installdir</value>
                </setInstallerVariable>
            </preShowPageActionList>
        </parameterGroup>
        <stringParameter>
            <name>odbc_reinstall_q</name>
            <description></description>
            <explanation></explanation>
            <value></value>
            <default></default>
            <allowEmptyValue>1</allowEmptyValue>
            <ask>0</ask>
            <width>40</width>
        </stringParameter>
        <stringParameter>
            <name>odbc_copy_path</name>
            <description></description>
            <explanation></explanation>
            <value></value>
            <default></default>
            <allowEmptyValue>1</allowEmptyValue>
            <ask>0</ask>
            <width>40</width>
        </stringParameter>
        <stringParameter>
            <name>ADONET_MSDTC_PATH</name>
            <description></description>
            <explanation></explanation>
            <value>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSDTC\XADLL</value>
            <default>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MSDTC\XADLL</default>
            <allowEmptyValue>0</allowEmptyValue>
            <ask>0</ask>
            <width>40</width>
        </stringParameter>
    </parameterList>
</project>

